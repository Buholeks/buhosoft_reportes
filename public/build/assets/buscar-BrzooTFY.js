document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll("[data-search-url]").forEach(d=>{let o=-1;const t=document.createElement("ul");d.parentNode.insertBefore(t,d.nextSibling);function c(e,n){let i;return function(...l){const a=this;clearTimeout(i),i=setTimeout(()=>e.apply(a,l),n)}}function r(){const e=d.dataset.searchUrl,n=d.value;document.getElementById(d.dataset.hiddenInputId),n?fetch(`${e}?term=${encodeURIComponent(n)}`).then(i=>i.json()).then(i=>{t.style.display="block",t.innerHTML="",o=-1,i.forEach(l=>{const a=document.createElement("li");a.classList.add("list-group-item"),a.dataset.id=l.id,a.textContent=l.nombre,t.appendChild(a)})}):(t.innerHTML="",t.style.display="none")}const u=c(r,300);d.addEventListener("input",u),d.addEventListener("keydown",function(e){const n=t.querySelectorAll("li");if(e.keyCode===40)o++,s(n);else if(e.keyCode===38)o--,s(n);else if(e.keyCode===13&&(e.preventDefault(),o>-1&&n.length)){d.value=n[o].textContent;const i=document.getElementById(d.dataset.hiddenInputId);i.value=n[o].dataset.id,t.innerHTML="",t.style.display="none"}}),t.addEventListener("click",function(e){if(e.target.tagName==="LI"){d.value=e.target.textContent;const n=document.getElementById(d.dataset.hiddenInputId);n.value=e.target.dataset.id,t.innerHTML="",t.style.display="none"}}),t.addEventListener("mouseover",function(e){e.target.tagName==="LI"&&e.target.classList.add("active")}),t.addEventListener("mouseout",function(e){e.target.tagName==="LI"&&e.target.classList.remove("active")});function s(e){if(!e)return!1;f(e),o>=e.length&&(o=0),o<0&&(o=e.length-1),e[o].classList.add("active")}function f(e){e.forEach(n=>n.classList.remove("active"))}t.classList.add("list-group","mt-3","position-absolute","w-50"),t.style.zIndex="1050",t.style.backgroundColor="white",t.style.boxShadow="0px 4px 6px rgba(0,0,0,0.1)"})});
